{% extends 'base.html' %}
{% block content %}

<div class="">
    <h1 class="mb-2">Promociones</h1>

    <!-- Botón para abrir el modal de registro -->
    <button type="button" class="btn btn-primary mb-3" data-toggle="modal" data-target="#registroPromocionModal">
        Registrar Nueva Promoción
    </button>


<!-- Tabla para mostrar las promociones -->
<table class="table table-promociones">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Descuento (COP)</th>
            <th>Fecha de Inicio</th>
            <th>Fecha de Fin</th>
            <th>Estado</th>
            <th>Código Promocional</th>
            <th>Condiciones</th>
            <th>Cantidad Mínima</th>
            <th>Cantidad Máxima</th>
        </tr>
    </thead>
    <tbody>
        {% for promocion in promociones %}
        <tr>
            <td><a href="{% url 'editar_promocion' promocion.id %}">{{ promocion.nombre }}</a></td>
            <td>{{ promocion.descripcion }}</td>
            <td>{{ promocion.descuento|floatformat:2 }}</td>
            <td>{{ promocion.fecha_inicio|date:"d/m/Y H:i" }}</td>
            <td>{{ promocion.fecha_fin|date:"d/m/Y" }}</td>
            <td>{{ promocion.activo|yesno:"Activo,Inactivo" }}</td>
            <td>{{ promocion.codigo_promocional }}</td>
            <td>{{ promocion.condiciones }}</td>
            <td>{{ promocion.cantidad_minima }}</td>
            <td>{{ promocion.cantidad_maxima }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="11">No hay promociones registradas.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

    <!-- Modal para registrar una nueva promoción -->
    <div class="modal fade" id="registroPromocionModal" tabindex="-1" aria-labelledby="registroPromocionModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="registroPromocionModalLabel">Registrar Nueva Promoción</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">
                    <!-- Formulario de Registro de Promoción -->
                    <form id="formRegistrarPromocion" method="POST" action="{% url 'registrar_promocion' %}">
                        {% csrf_token %}
                        <div class="form-group">
                            <label for="nombre">Nombre de la Promoción</label>
                            <input type="text" class="form-control" id="nombre" name="nombre" required>
                        </div>

                        <div class="form-group">
                            <label for="descripcion">Descripción</label>
                            <textarea class="form-control" id="descripcion" name="descripcion" rows="3"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="descuento">Descuento (COP)</label>
                            <input type="number" class="form-control" id="descuento" name="descuento" step="0.01" required>
                        </div>

                        <div class="form-group">
                            <label for="fecha_inicio">Fecha de Inicio</label>
                            <input type="datetime-local" class="form-control" id="fecha_inicio" name="fecha_inicio" required>
                        </div>

                        <div class="form-group">
                            <label for="fecha_fin">Fecha de Fin</label>
                            <input type="date" class="form-control" id="fecha_fin" name="fecha_fin" required>
                        </div>

                        <div class="form-group">
                            <label for="codigo_promocional">Código Promocional (Opcional)</label>
                            <input type="text" class="form-control" id="codigo_promocional" name="codigo_promocional">
                        </div>

                        <div class="form-group">
                            <label for="condiciones">Condiciones</label>
                            <textarea class="form-control" id="condiciones" name="condiciones" rows="3"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="cantidad_minima">Cantidad Mínima (Opcional)</label>
                            <input type="number" class="form-control" id="cantidad_minima" name="cantidad_minima">
                        </div>

                        <div class="form-group">
                            <label for="cantidad_maxima">Cantidad Máxima (Opcional)</label>
                            <input type="number" class="form-control" id="cantidad_maxima" name="cantidad_maxima">
                        </div>

                        <button type="submit" class="btn btn-primary">Registrar Promoción</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}